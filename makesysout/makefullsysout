(DEFINE-FILE-INFO READTABLE "INTERLISP" PACKAGE "INTERLISP")(FILECREATED "29-Nov-2020 10:01:42" {DSK}<home>larry>ilisp>medley>makesysout>makefullsysout.;107 11923        changes to%:  (FNS MAKEFULLSYSOUT LOADFULLFONTS LOADNFS)                    (COMMANDS "cd" "pwd" "ls")                    (VARS MAKEFULLSYSOUTCOMS)      previous date%: "28-Nov-2020 16:56:44" {DSK}<home>larry>ilisp>medley>makesysout>makefullsysout.;105)(PRETTYCOMPRINT MAKEFULLSYSOUTCOMS)(RPAQQ MAKEFULLSYSOUTCOMS       ((COMMANDS "cd" "pwd" "ls")        (FNS LOADFULLFONTS MAKEFULLSYSOUT FIXMETA)        (P (FIXMETA))        (FNS LoadPatches COLLECT-PATCH-FILES)        (INITVARS (WRITEFULLSYSOUTFLAG T))        (VARS (COPYRIGHTFLG NIL))        (GLOBALVARS MISSINGDISPLAYFONTCOERCIONS MISSINGCHARSETDISPLAYFONTCOERCIONS)        (DECLARE%: DONTEVAL@LOAD DONTEVAL@COMPILE DOCOPY (P (MAKEFULLSYSOUT)))        (PROP FILETYPE MAKEFULLSYSOUT)))(DEFCOMMAND "cd" (DIR) (/CNDIR DIR))(DEFCOMMAND "pwd" NIL (DIRECTORYNAME T))(DEFCOMMAND "ls" (FIRST . REST) (DODIR (CONS FIRST REST)))(DEFINEQ(LOADFULLFONTS  [LAMBDA (ROOTDIRECTORY)                                    (* ;                                                            "Edited 11-Aug-2020 17:53 by rmk:")    (* ;; " Don't do Interpress. Do character set 0 and the symbol character sets 41Q, 42Q, 356Q, 357Q and extended and accented Latin 43Q and 361Q")    (PRINTOUT T "Loading FULL fonts..." T)    (SETQ DISPLAYFONTDIRECTORIES (LIST (PACK* ROOTDIRECTORY "/fonts/displayfonts")                                       (PACK* ROOTDIRECTORY "/fonts/altofonts")))                                                             (* (SETQ INTERPRESSFONTDIRECTORIES                                                           (CONS (PACK* ROOTDIRECTORY                                                            "/fonts/ipfonts"))))    (SETQ DISPLAYFONTEXTENSIONS '(DISPLAYFONT STRIKE))    (SETQ POSTSCRIPTFONTDIRECTORIES (CONS (PACK* ROOTDIRECTORY "/fonts/postscriptfonts")))    (SETQ *POSTSCRIPT-FILE-TYPE* 'TEXT)    (RESETVARS ((MISSINGDISPLAYFONTCOERCIONS NIL)                (MISSINGCHARSETDISPLAYFONTCOERCIONS NIL))    (* ;                   "Don't let the font loader substitute just because a server went catatonic on us")               (for FAMILY in '(CLASSIC MODERN TERMINAL)                  do (PRINTOUT T "  Loading " FAMILY " ")                        [for SIZE in '(8 10 12)                           do (PRINTOUT T SIZE " ")                                 (for FACE in '(MRR BRR MIR)                                    do                                           (* ;; "No need for Interpress")                                                             (* (NLSETQ (FONTCREATE FAMILY SIZE                                                            FACE NIL (QUOTE INTERPRESS) NIL 0)))                                          (for CSET                                             in '(0 33 34 35 238 239 241)                                             do (NLSETQ (FONTCREATE FAMILY SIZE FACE NIL                                                                   'DISPLAY NIL CSET]                        (PRINTOUT T T))               (PRINTOUT T "  Loading postscript fonts" T)               (for F in (FILDIR (CONCAT (CAR POSTSCRIPTFONTDIRECTORIES)                                                ">c0>*.*")) do (PSCFONT.READFONT F))               (PRINTOUT T "FULL fonts loaded" T])(MAKEFULLSYSOUT  [LAMBDA NIL                                          (* ; "Edited 29-Nov-2020 10:01 by larry")                                                             (* ;                                                            "Edited 14-May-2018 15:01 by kaplan")                                                             (* ;                                                            "Edited 28-Sep-2020 12:35 by rmk:")                                                             (* ; "Edited 17-Apr-2018 08:41 by ")                                                             (* ;                                                            "Edited 21-Apr-2018 07:27 by rmk:")                                                             (* ; "Edited 23-Feb-94 15:04 by bvm")                                                             (* ; "Edited  2-Apr-90 14:42 by bbb")(* ;;; "This file makes xfull35.sysout based on Venue's Lisp.sysout 3.5.  Start LISP.SYSOUT, connect to MEDLEYDIR for Lisp, connect to MEDLEYDIR/lispcore for lispcore.  Then load makefullsysout/MAKEFULLSYSOUT.LCOM.")(* ;;; "If sysout looks good, copy to release (basics?)")(* ;;; "")    (CLRPROMPT)    (CNDIR (UNIX-GETENV "LOADUPDIR"))    (LET ((ROOTDIRECTORY (DIRECTORYNAME T)))                 (* ;                                                         "E.g. medley3.5/lisp or medley3.5/lispcore")         (SETQ MAKESYSFILENAME (PACK* ROOTDIRECTORY "loadups/xfull35.sysout"))                                                             (* ; "Should bind MAKESYSFILENAME")         (DRIBBLE (PACKFILENAME 'EXTENSION 'DRIBBLE 'BODY MAKESYSFILENAME))         (* ;; "BKSYSBUF stops page holding ")         (PRINTOUT T T "Full loadup started at " (DATE)                " while connected to "                (DIRECTORYNAME T)                T T)         (BKSYSBUF " ")         (SETQ DEFAULTFILETYPE 'BINARY)                      (* ;                                       "These prevent bits from being lost due to lack of knowledge")         (DREMOVE (ASSOC NIL DEFAULTFILETYPELIST)                DEFAULTFILETYPELIST)                         (* (SETQ *UPPER-CASE-FILE-NAMES* NIL))         (SETQ MAKESYSNAME :MEDLEY3.5)         (push DEFAULTFILETYPELIST '(TXT . TEXT)                '(TEXT . TEXT)                '(TEX . TEXT)                '(HTML . TEXT)                '(HTM . TEXT))         (SETQ LISPSOURCEDIRECTORIES (LIST (PACK* ROOTDIRECTORY "sources")))         (SETQ LISPUSERSDIRECTORIES (LIST (PACK* ROOTDIRECTORY "library")                                          (PACK* ROOTDIRECTORY "lispusers")))         (SETQ DIRECTORIES (APPEND LISPUSERSDIRECTORIES LISPSOURCEDIRECTORIES DIRECTORIES))         (SETQ LOADUPDIRECTORIES DIRECTORIES)         (LOADUP '(POSTSCRIPTSTREAM))                        (* ; " to get PSCFONT.READFONT")         (LOADFULLFONTS ROOTDIRECTORY)         (LISTPUT IDLE.PROFILE 'TIMEOUT 0)         (SETQQ *DEFAULT-CLEANUP-COMPILER* BCOMPL)         (LOADUP '(CHAT TEDIT HRULE TEDITCHAT READNUMBER EDITBITMAP FILEBROWSER THINFILES GRAPHER SPY                        WHERE-IS COPYFILES MSANALYZE MSPARSE MASTERSCOPE UNIXPRINT UNICODE HELPSYS                         DINFO CLIPBOARD MACINTERFACE))         [NLSETQ (LOADUP '(ISO8859IO]         (FILESLOAD (SYSLOAD)                PRETTYFILEINDEX WHO-LINE)         (SETQ *WHO-LINE-ANCHOR* '(:CENTER :TOP))         (* ;; "Turn off who-line until after the user has greeted")         (CL:WHEN (WINDOWP *WHO-LINE*)                (CLOSEW *WHO-LINE*))         [SETQ POSTGREETFORMS (APPEND POSTGREETFORMS '((INSTALL-WHO-LINE-OPTIONS]         (FILESLOAD (SYSLOAD)                UNIXCOMM UNIXCHAT UNIXTELNET)         (FILESLOAD (SYSLOAD)                SETDEFAULTPRINTER)         (FILESLOAD (SYSLOAD)                LOADPATCHES)         (\DAYTIME0 \LASTUSERACTION)         (LISTPUT IDLE.PROFILE 'TIMEOUT 20)         (for TYPE in FILEPKTYPES do (FILEPKGCHANGES TYPE NIL))         (SETTOPVAL 'INITIALS NIL)         (PROMPTPRINT "About to end loadup")         (PRINTOUT T "About to end loadup" T)         (* ;; "From SYNCLISPFILES")         (ENDLOADUP)         (CL:WHEN LOGOW (CLOSEW LOGOW))         (push AFTERMAKESYSFORMS '(CLRPROMPT))         (* ;; "Set up for making the sysout, if we made it this far.")         (CL:WHEN WRITEFULLSYSOUTFLAG             (PRINTOUT T "Creating FULL sysout on " MAKESYSFILENAME T)             (BKSYSBUF (CONCAT "(IL:MAKESYS %"" MAKESYSFILENAME "%" %"Medley " (MEDLEYVERSION)                              " Full Sysout%")")))         (DRIBBLE])(FIXMETA  [LAMBDA NIL                                           (* ; "Edited 25-Jun-2017 17:12 by rmk:")    (KEYACTION 'BLANK-TOP '(METADOWN . METAUP)           \CURRENTKEYACTION)    (KEYACTION 'BLANK-TOP '(METADOWN . METAUP]))(FIXMETA)(DEFINEQ(LoadPatches  [LAMBDA (DIRECTORY LDFLG AFTERDATE)                    (* ; "Edited  7-Feb-92 11:50 by bbb")(* ;;; "Load all compiled files from the directory")    (DECLARE (GLOBALVARS *COMPILED-EXTENSIONS*))    (LET [(files (SORT (for EXT in *COMPILED-EXTENSIONS*                          bind (AFTERIDATE _ (if AFTERDATE                                                     then (OR (IDATE AFTERDATE)                                                                  0)                                                   else 0)) join (COLLECT-PATCH-FILES                                                                          (DIRECTORYNAME DIRECTORY)                                                                          EXT AFTERIDATE))                       (FUNCTION (LAMBDA (X Y)                                   (LESSP (CDR X)                                          (CDR Y]            (* ;                                                            "files are sorted by increasing date")         (for file in files do (SELECTQ LDFLG                                               (HIDDEN       (* ;                                                        "Load the file, but don't put it on FILELST")                                                       (LOAD? (CAR file)                                                              T)                                                       (SETQ FILELST (DREMOVE (FILENAMEFIELD                                                                               (CAR file)                                                                               'NAME)                                                                            FILELST)))                                               (LOAD? (CAR file)                                                      LDFLG)))         files])(COLLECT-PATCH-FILES  [LAMBDA (DIRECTORY EXT AFTERIDATE)                     (* ; "Edited  7-Feb-92 11:49 by bbb")    (* ;; "Generate list of files in DIRECTORY with extension EXT more recent than idate AFTERIDATE.  Return list of pairs (file . date).  Omits subdirectories.")    (RESETLST        (LET ((FILING.ENUMERATION.DEPTH 1)              (NAKED-DIR (UNPACKFILENAME.STRING DIRECTORY 'DIRECTORY))              FILE DATE)             (bind [GEN _ (\GENERATEFILES (CONCAT DIRECTORY "*." EXT ";")                                     '(ICREATIONDATE)                                     '(SORT RESETLST] while (SETQ FILE (\GENERATENEXTFILE GEN))                when (AND (STRING-EQUAL (UNPACKFILENAME.STRING FILE 'DIRECTORY)                                     NAKED-DIR)                              (> (SETQ DATE (\GENERATEFILEINFO GEN 'ICREATIONDATE))                                 AFTERIDATE)) collect (CONS FILE DATE))))]))(RPAQ? WRITEFULLSYSOUTFLAG T)(RPAQQ COPYRIGHTFLG NIL)(DECLARE%: DOEVAL@COMPILE DONTCOPY(GLOBALVARS MISSINGDISPLAYFONTCOERCIONS MISSINGCHARSETDISPLAYFONTCOERCIONS))(DECLARE%: DONTEVAL@LOAD DONTEVAL@COMPILE DOCOPY (MAKEFULLSYSOUT))(PUTPROPS MAKEFULLSYSOUT FILETYPE :TCOMPL)(PUTPROPS MAKEFULLSYSOUT COPYRIGHT (NONE))(DECLARE%: DONTCOPY  (FILEMAP (NIL (1088 8597 (LOADFULLFONTS 1098 . 3602) (MAKEFULLSYSOUT 3604 . 8351) (FIXMETA 8353 . 8595)) (8613 11552 (LoadPatches 8623 . 10571) (COLLECT-PATCH-FILES 10573 . 11550)))))STOP