(DEFINE-FILE-INFO READTABLE "INTERLISP" PACKAGE "INTERLISP")(FILECREATED "24-Aug-2020 20:43:30" {DSK}<Users>kaplan>Local>medley3.5>lispcore>makesysout>makefullsysout.;100 14111        changes to%:  (FNS LOADNFS MAKEFULLSYSOUT)      previous date%: "11-Aug-2020 17:53:49" {DSK}<Users>kaplan>Local>medley3.5>lispcore>makesysout>makefullsysout.;99)(PRETTYCOMPRINT MAKEFULLSYSOUTCOMS)(RPAQQ MAKEFULLSYSOUTCOMS       ((COMMANDS "cd" "pwd" "ls")        (FNS LOADFULLFONTS LOADNFS MAKEFULLSYSOUT PAGEHEIGHT FIXMETA)        (P (FIXMETA))        (FNS LoadPatches COLLECT-PATCH-FILES)        (INITVARS (WRITEFULLSYSOUTFLAG T))        (VARS (COPYRIGHTFLG NIL))        (GLOBALVARS MISSINGDISPLAYFONTCOERCIONS MISSINGCHARSETDISPLAYFONTCOERCIONS)        (DECLARE%: DONTEVAL@LOAD DONTEVAL@COMPILE DOCOPY (P (MAKEFULLSYSOUT)))        (PROP FILETYPE MAKEFULLSYSOUT)))(DEFCOMMAND "cd" (DIR) (/CNDIR DIR))(DEFCOMMAND "pwd" NIL (DIRECTORYNAME T))(DEFCOMMAND "ls" (FIRST . REST) (DODIR (CONS FIRST REST)))(DEFINEQ(LOADFULLFONTS  [LAMBDA (ROOTDIRECTORY)                               (* ; "Edited 11-Aug-2020 17:53 by rmk:")    (* ;; " Don't do Interpress. Do character set 0 and the symbol character sets 41Q, 42Q, 356Q, 357Q and extended and accented Latin 43Q and 361Q")    (PRINTOUT T "Loading FULL fonts..." T)    (SETQ DISPLAYFONTDIRECTORIES (LIST (PACK* ROOTDIRECTORY "/fonts/displayfonts")                                       (PACK* ROOTDIRECTORY "/fonts/altofonts")))                                                             (* (SETQ INTERPRESSFONTDIRECTORIES                                                           (CONS (PACK* ROOTDIRECTORY                                                            "/fonts/ipfonts"))))    (SETQ DISPLAYFONTEXTENSIONS '(DISPLAYFONT STRIKE))    (SETQ POSTSCRIPTFONTDIRECTORIES (CONS (PACK* ROOTDIRECTORY "/fonts/postscriptfonts")))    (SETQ *POSTSCRIPT-FILE-TYPE* 'TEXT)    (RESETVARS ((MISSINGDISPLAYFONTCOERCIONS NIL)                (MISSINGCHARSETDISPLAYFONTCOERCIONS NIL))    (* ;                   "Don't let the font loader substitute just because a server went catatonic on us")               (FOR FAMILY IN '(CLASSIC MODERN TERMINAL)                  DO (PRINTOUT T "  Loading " FAMILY " ")                        [FOR SIZE IN '(8 10 12)                           DO (PRINTOUT T SIZE " ")                                 (FOR FACE IN '(MRR BRR MIR)                                    DO                                           (* ;; "No need for Interpress")                                                             (* (NLSETQ (FONTCREATE FAMILY SIZE                                                            FACE NIL (QUOTE INTERPRESS) NIL 0)))                                          (FOR CSET                                             IN '(0 33 34 35 238 239 241)                                             DO (NLSETQ (FONTCREATE FAMILY SIZE FACE NIL                                                                   'DISPLAY NIL CSET]                        (PRINTOUT T T))               (PRINTOUT T "  Loading postscript fonts" T)               (FOR F IN (FILDIR (CONCAT (CAR POSTSCRIPTFONTDIRECTORIES)                                                ">c0>*.*")) DO (PSCFONT.READFONT F))               (PRINTOUT T "FULL fonts loaded" T])(LOADNFS  [LAMBDA NIL                                           (* ; "Edited 24-Aug-2020 20:38 by rmk:")                                                             (* ;                                                            "Edited  8-Jun-94 14:20 by kaplan")                                                             (* ; "Edited 16-Mar-90 14:07 by bbb")(* ;;; "Function assumes that all directories are properly set")(* ;;; "loads MINI-NFS and other related files")    (* ;; "Moved UNIXCOMM, UNIXCHAT into the main MAKEFULLSYSOUT")    (FILESLOAD (SYSLOAD FROM "{dsk}<project>medley3.5>nfs>")           MINI-NFS)    [COND       (T                                                    (* ;                                        "Load Bill's patch to allow Sun users to refer to server/n.")          (FILESLOAD (SYSLOAD)                 UFSNFS))       (T           (* ;; "Pray...")          (\DEFINEDEVICE 'nfs 'dsk]    (FILESLOAD (SYSLOAD FROM "{dsk}<project>medley3.5>nfs>")           RPCOS)    (FILESLOAD (SYSLOAD)           RWALLSERVER NFSPROTECTION])(MAKEFULLSYSOUT  [LAMBDA NIL                                                (* ;                                                            "Edited 14-May-2018 15:01 by kaplan")                                                             (* ;                                                            "Edited 24-Aug-2020 20:43 by rmk:")                                                             (* ; "Edited 17-Apr-2018 08:41 by ")                                                             (* ;                                                            "Edited 21-Apr-2018 07:27 by rmk:")                                                             (* ; "Edited 23-Feb-94 15:04 by bvm")                                                             (* ; "Edited  2-Apr-90 14:42 by bbb")(* ;;; "This file makes xfull35.sysout based on Venue's Lisp.sysout 3.5.  Start LISP.SYSOUT, connect to MEDLEYDIR for Lisp, connect to MEDLEYDIR/lispcore for lispcore.  Then load makefullsysout/MAKEFULLSYSOUT.LCOM.")(* ;;; "If sysout looks good, copy to release (basics?)")(* ;;; "")    (CLRPROMPT)    (CNDIR (UNIX-GETENV "LOADUPDIR"))    (LET ((ROOTDIRECTORY (DIRECTORYNAME T)))                 (* ;                                                         "E.g. medley3.5/lisp or medley3.5/lispcore")         (SETQ MAKESYSFILENAME (PACK* ROOTDIRECTORY "xfull35.sysout"))                                                             (* ; "Should bind MAKESYSFILENAME")         (DRIBBLE (PACKFILENAME 'EXTENSION 'dribble 'BODY MAKESYSFILENAME))         (* ;; "BKSYSBUF stops page holding ")         (PRINTOUT T T "Full loadup started at " (DATE)                " while connected to "                (DIRECTORYNAME T)                T T)         (BKSYSBUF " ")         (SETQ DEFAULTFILETYPE 'BINARY)                      (* ;                                       "These prevent bits from being lost due to lack of knowledge")         (DREMOVE (ASSOC NIL DEFAULTFILETYPELIST)                DEFAULTFILETYPELIST)                         (* (SETQ *UPPER-CASE-FILE-NAMES* NIL))         (SETQ MAKESYSNAME :MEDLEY3.5)         (PUSH DEFAULTFILETYPELIST '(TXT . TEXT)                '(TEXT . TEXT)                '(TEX . TEXT)                '(HTML . TEXT)                '(HTM . TEXT))         (SETQ LISPSOURCEDIRECTORIES (LIST (PACK* ROOTDIRECTORY "sources")))         (SETQ LISPUSERSDIRECTORIES (LIST (PACK* ROOTDIRECTORY "library")                                          (PACK* ROOTDIRECTORY "lispusers")))         (SETQ DIRECTORIES (APPEND LISPUSERSDIRECTORIES LISPSOURCEDIRECTORIES DIRECTORIES))         (SETQ LOADUPDIRECTORIES DIRECTORIES)         (* ;; "(FILESLOAD (SYSLOAD FROM VALUEOF (PACK* ROOTDIRECTORY %"patches%")) FINDFONTPATCH)")         (LOADUP '(POSTSCRIPTSTREAM))                        (* ; " to get PSCFONT.READFONT")         (LOADFULLFONTS ROOTDIRECTORY)         (LISTPUT IDLE.PROFILE 'TIMEOUT 0)         (SETQQ *DEFAULT-CLEANUP-COMPILER* BCOMPL)           (* ; "Skip DOSPRINT, assume only UNIX")         (LOADUP '(CHAT NSCHAT TEDIT HRULE TEDITCHAT READNUMBER EDITBITMAP FILEBROWSER THINFILES                         GRAPHER SPY WHERE-IS COPYFILES MSANALYZE MSPARSE MASTERSCOPE UNIXPRINT                         UNICODE ISO8859IO CLIPBOARD MACINTERFACE))         (* ;; "Useful SSL stuff ")         (AND NIL (FILESLOAD (SYSLOAD)                         NSMAINTAIN NSPROTECTION))         (FILESLOAD (SYSLOAD)                PRETTYFILEINDEX WHO-LINE NSCOPYFILE)         (* ;; "Turn off who-line until after the user has greeted")         (CL:WHEN (WINDOWP *WHO-LINE*)                (CLOSEW *WHO-LINE*))         [SETQ POSTGREETFORMS (APPEND POSTGREETFORMS '((INSTALL-WHO-LINE-OPTIONS]         (FILELOAD (SYSLOAD)                UNIXCOMM UNIXCHAT UNIXTELNET)         (CL:WHEN NIL             (FILESLOAD (SYSLOAD)                    ARCHIVETOOL)             (SETQ CH.DEFAULT.DOMAIN "PARC")             (SETQ CH.DEFAULT.ORGANIZATION "XEROX")             (LOADNFS)             (* ;; "Load in the newest Lafite")             (FILESLOAD (SYSLOAD)                    LAFITE MIME LAFITE-INDENT NSMAIL NEWNSMAIL UNIXMAIL)             (FILESLOAD (SYSLOAD)                    SYSTEM33))         (FILESLOAD (SYSLOAD)                SETDEFAULTPRINTER)         (* ;; "Load the patches last")         (FILESLOAD (SYSLOAD)                LOADPATCHES)         (LoadPatches (PACK* ROOTDIRECTORY "patches>")                'SYSLOAD NIL)         (* ;; "Turn on Meta key for Dorados:  (METASHIFT T)")         (\DAYTIME0 \LASTUSERACTION)         (LISTPUT IDLE.PROFILE 'TIMEOUT 20)         (FOR TYPE IN FILEPKTYPES DO (FILEPKGCHANGES TYPE NIL))         (PACK* ROOTDIRECTORY "xfull35.sysout")         (SETTOPVAL 'INITIALS NIL)         (PROMPTPRINT "About to end loadup")         (PRINTOUT T "About to end loadup" T)         (* ;; "From SYNCLISPFILES")         (ENDLOADUP)         (CL:WHEN LOGOW (CLOSEW LOGOW))         (LOGOW)         (PUSH AFTERMAKESYSFORMS '(CLRPROMPT))         (* ;; "Set up for making the sysout, if we made it this far.")         (CL:WHEN WRITEFULLSYSOUTFLAG             (PRINTOUT T "Creating FULL sysout on " MAKESYSFILENAME T)             (BKSYSBUF (CONCAT "(IL:MAKESYS %"" MAKESYSFILENAME "%" %"Medley " (MEDLEYVERSION)                              " Full Sysout%")")))         (DRIBBLE])(PAGEHEIGHT  [LAMBDA (N)                                          (* ; "Edited 20-Jul-88 10:13 by Burwell")    (* ;; "sets the page height in lines of the screen.")    (* ;; "20-Jul-88:  Took out the (SETQ \CURRENTDISPLAYLINE 0)")    (PROG1 \#DISPLAYLINES        (COND           ((NUMBERP N)            (SETQ \#DISPLAYLINES N))))])(FIXMETA  [LAMBDA NIL                                           (* ; "Edited 25-Jun-2017 17:12 by rmk:")    (KEYACTION 'BLANK-TOP '(METADOWN . METAUP)           \CURRENTKEYACTION)    (KEYACTION 'BLANK-TOP '(METADOWN . METAUP]))(FIXMETA)(DEFINEQ(LoadPatches  [LAMBDA (DIRECTORY LDFLG AFTERDATE)                    (* ; "Edited  7-Feb-92 11:50 by bbb")(* ;;; "Load all compiled files from the directory")    (DECLARE (GLOBALVARS *COMPILED-EXTENSIONS*))    (LET [(files (SORT (for EXT in *COMPILED-EXTENSIONS*                          bind (AFTERIDATE _ (if AFTERDATE                                                     then (OR (IDATE AFTERDATE)                                                                  0)                                                   else 0)) join (COLLECT-PATCH-FILES                                                                          (DIRECTORYNAME DIRECTORY)                                                                          EXT AFTERIDATE))                       (FUNCTION (LAMBDA (X Y)                                   (LESSP (CDR X)                                          (CDR Y]            (* ;                                                            "files are sorted by increasing date")         (for file in files do (SELECTQ LDFLG                                               (HIDDEN       (* ;                                                        "Load the file, but don't put it on FILELST")                                                       (LOAD? (CAR file)                                                              T)                                                       (SETQ FILELST (DREMOVE (FILENAMEFIELD                                                                               (CAR file)                                                                               'NAME)                                                                            FILELST)))                                               (LOAD? (CAR file)                                                      LDFLG)))         files])(COLLECT-PATCH-FILES  [LAMBDA (DIRECTORY EXT AFTERIDATE)                     (* ; "Edited  7-Feb-92 11:49 by bbb")    (* ;; "Generate list of files in DIRECTORY with extension EXT more recent than idate AFTERIDATE.  Return list of pairs (file . date).  Omits subdirectories.")    (RESETLST        (LET ((FILING.ENUMERATION.DEPTH 1)              (NAKED-DIR (UNPACKFILENAME.STRING DIRECTORY 'DIRECTORY))              FILE DATE)             (bind [GEN _ (\GENERATEFILES (CONCAT DIRECTORY "*." EXT ";")                                     '(ICREATIONDATE)                                     '(SORT RESETLST] while (SETQ FILE (\GENERATENEXTFILE GEN))                when (AND (STRING-EQUAL (UNPACKFILENAME.STRING FILE 'DIRECTORY)                                     NAKED-DIR)                              (> (SETQ DATE (\GENERATEFILEINFO GEN 'ICREATIONDATE))                                 AFTERIDATE)) collect (CONS FILE DATE))))]))(RPAQ? WRITEFULLSYSOUTFLAG T)(RPAQQ COPYRIGHTFLG NIL)(DECLARE%: DOEVAL@COMPILE DONTCOPY(GLOBALVARS MISSINGDISPLAYFONTCOERCIONS MISSINGCHARSETDISPLAYFONTCOERCIONS))(DECLARE%: DONTEVAL@LOAD DONTEVAL@COMPILE DOCOPY (MAKEFULLSYSOUT))(PUTPROPS MAKEFULLSYSOUT FILETYPE :TCOMPL)(PUTPROPS MAKEFULLSYSOUT COPYRIGHT (NONE))(DECLARE%: DONTCOPY  (FILEMAP (NIL (1028 10785 (LOADFULLFONTS 1038 . 3477) (LOADNFS 3479 . 4613) (MAKEFULLSYSOUT 4615 . 10176) (PAGEHEIGHT 10178 . 10539) (FIXMETA 10541 . 10783)) (10801 13740 (LoadPatches 10811 . 12759) (COLLECT-PATCH-FILES 12761 . 13738)))))STOP