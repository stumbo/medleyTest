(DEFINE-FILE-INFO READTABLE "INTERLISP" PACKAGE "INTERLISP")(FILECREATED "18-May-2020 20:12:57" {DSK}<Users>kaplan>Local>medley3.5>lispcore>lispusers>MACINTERFACE.;28 8463         changes to%:  (FNS MACWINDOW)      previous date%: "18-May-2020 17:27:13" {DSK}<Users>kaplan>Local>medley3.5>lispcore>lispusers>MACINTERFACE.;27)(PRETTYCOMPRINT MACINTERFACECOMS)(RPAQQ MACINTERFACECOMS       [(FNS INTITLEBAR INCORNER MACWINDOW.BUTTONEVENTFN MACWINDOW)        (FNS MACINT\TEDIT.BUTTONEVENTFN MACINT\SEDIT-BUTTONEVENTFN MACINT-ADD-EXEC              MACINT-DEBUGGER-BUTTON-EVENT MACINT-\ITEM.WINDOW.BUTTON.HANDLER MACINT-SNAPW)        (INITVARS (MACINTERFACECORNERMARGIN 25))        (P (MOVD? '\TEDIT.BUTTONEVENTFN 'MACORIG\TEDIT.BUTTONEVENTFN)           (MOVD 'MACINT\TEDIT.BUTTONEVENTFN '\TEDIT.BUTTONEVENTFN))        (P (MOVD? 'SEDIT::BUTTONEVENTFN 'MACORIG\SEDIT-BUTTONEVENTFN)           (MOVD 'MACINT\SEDIT-BUTTONEVENTFN 'SEDIT::BUTTONEVENTFN))        (P (MOVD? 'ADD-EXEC 'MACORIG-ADD-EXEC)           (MOVD 'MACINT-ADD-EXEC 'ADD-EXEC))        (P (MOVD? 'DBG::DEBUGGER-BUTTON-EVENT 'MACORIG-DEBUGGER-BUTTON-EVENT)           (MOVD 'MACINT-DEBUGGER-BUTTON-EVENT 'DBG::DEBUGGER-BUTTON-EVENT))        (P (MOVD? '\ITEM.WINDOW.BUTTON.HANDLER 'MACORIG-\ITEM.WINDOW.BUTTON.HANDLER)           (MOVD 'MACINT-\ITEM.WINDOW.BUTTON.HANDLER '\ITEM.WINDOW.BUTTON.HANDLER))        (P (MOVD? 'SNAPW 'MACORIG-SNAPW)           (MOVD 'MACINT-SNAPW 'SNAPW))        (DECLARE%: DONTEVAL@LOAD DOEVAL@COMPILE DONTCOPY COMPILERVARS (ADDVARS (NLAMA)                                                                             (NLAML)                                                                             (LAMA MACINT-ADD-EXEC])(DEFINEQ(INTITLEBAR  [LAMBDA (WINDOW)                                      (* ; "Edited  3-May-2020 20:38 by rmk:")    (IGREATERP (LASTMOUSEY WINDOW)           (FETCH TOP OF (DSPCLIPPINGREGION NIL WINDOW])(INCORNER  [LAMBDA (WINDOW MARGIN)                               (* ; "Edited 13-May-2020 14:26 by rmk:")                                                            (* ; "Edited 10-May-2020 12:41 by rmk:")                                                            (* ; "Edited  3-May-2020 20:43 by rmk:")    (CL:UNLESS MARGIN (SETQ MARGIN MACINTERFACECORNERMARGIN))    (LET ((CR (DSPCLIPPINGREGION NIL WINDOW))          (X (LASTMOUSEX WINDOW))          (Y (LASTMOUSEY WINDOW)))         (IF (ILEQ (IABS (IDIFFERENCE X (FETCH LEFT OF CR)))                       MARGIN)             THEN                    (* ;; "GREATERP puts it in title bar")                   (IF (IGREATERP Y (FETCH TOP OF CR))                       THEN 'LEFTTOP                     ELSEIF (ILEQ (IABS (IDIFFERENCE Y (FETCH BOTTOM OF CR)))                                      MARGIN)                       THEN 'LEFTBOTTOM)           ELSEIF (ILEQ (IABS (IDIFFERENCE X (FETCH RIGHT OF CR)))                            MARGIN)             THEN (IF (IGREATERP Y (FETCH TOP OF CR))                          THEN 'RIGHTTOP                        ELSEIF (ILEQ (IABS (IDIFFERENCE Y (FETCH BOTTOM OF CR)))                                         MARGIN)                          THEN 'RIGHTBOTTOM])(MACWINDOW.BUTTONEVENTFN  [LAMBDA (WINDOW)                                      (* ; "Edited 10-May-2020 03:35 by rmk:")                                                            (* ; "Edited  3-May-2020 21:18 by rmk:")    (CL:WHEN (MOUSESTATE (ONLY LEFT))        (TOTOPW WINDOW)        (LET (REGION (CORNER (INCORNER WINDOW)))             (IF CORNER                 THEN                        (* ;;                      "The upper corners may be in the title bar, near the side, so test this first")                       (SETQ REGION (WINDOWPROP WINDOW 'REGION))                       [LET ((LEFT (FETCH LEFT OF REGION))                             (RIGHT (FETCH RIGHT OF REGION))                             (TOP (FETCH TOP OF REGION))                             (BOTTOM (FETCH BOTTOM OF REGION)))                            (SHAPEW WINDOW (GETREGION NIL NIL NIL NIL NIL                                                  (SELECTQ CORNER                                                      (RIGHTBOTTOM (LIST LEFT TOP RIGHT BOTTOM))                                                      (LEFTBOTTOM (LIST RIGHT TOP LEFT BOTTOM))                                                      (RIGHTTOP (LIST LEFT BOTTOM RIGHT TOP))                                                      (LEFTTOP (LIST RIGHT BOTTOM LEFT TOP))                                                      (SHOULDNT]                       T               ELSEIF (INTITLEBAR WINDOW)                 THEN (MOVEW WINDOW)                       T)))])(MACWINDOW  [LAMBDA (WINDOW)                                      (* ; "Edited 18-May-2020 20:11 by rmk:")                                                            (* ; "Edited 10-May-2020 14:20 by rmk:")    (* ;; "This can be applied to windows that have been created with an unknown or unmodifiable buttoneventfn.")                                                        (* ; "Edited  3-May-2020 21:17 by rmk:")    (CL:UNLESS (WINDOWPROP WINDOW 'PREMACBUTTONEVENTFN)        (WINDOWPROP WINDOW 'PREMACBUTTONEVENTFN (WINDOWPROP WINDOW 'BUTTONEVENTFN))        (WINDOWPROP WINDOW 'BUTTONEVENTFN (FUNCTION MACWINDOW.BUTTONEVENTFN)))    WINDOW]))(DEFINEQ(MACINT\TEDIT.BUTTONEVENTFN  [LAMBDA (WINDOW)                                      (* ; "Edited 10-May-2020 03:31 by rmk:")    (CL:WHEN (LISTP WINDOW)        (SETQ WINDOW (CAR WINDOW)))    (OR (MACWINDOW.BUTTONEVENTFN WINDOW)        (MACORIG\TEDIT.BUTTONEVENTFN WINDOW])(MACINT\SEDIT-BUTTONEVENTFN  [LAMBDA (WINDOW)                                      (* ; "Edited 10-May-2020 03:31 by rmk:")    (OR (MACWINDOW.BUTTONEVENTFN WINDOW)        (MACORIG\SEDIT-BUTTONEVENTFN WINDOW])(MACINT-ADD-EXEC  [LAMBDA U                                             (* ; "Edited 10-May-2020 03:31 by rmk:")    (LET [(PROC (APPLY (FUNCTION MACORIG-ADD-EXEC)                       (FOR N FROM 1 TO U COLLECT (ARG U N]         (* ;; "For some reason, the window may not be there immediately")         (DISMISS 100)         (MACWINDOW (PROCESSPROP PROC 'WINDOW))         PROC])(MACINT-DEBUGGER-BUTTON-EVENT  [LAMBDA (WINDOW)                                      (* ; "Edited 10-May-2020 03:31 by rmk:")    (OR (MACWINDOW.BUTTONEVENTFN WINDOW)        (MACORIG-DEBUGGER-BUTTON-EVENT WINDOW])(MACINT-\ITEM.WINDOW.BUTTON.HANDLER  [LAMBDA (WINDOW)                                      (* ; "Edited 16-May-2020 22:35 by rmk:")                                                            (* ; "Edited 10-May-2020 03:31 by rmk:")    (OR (MACWINDOW.BUTTONEVENTFN WINDOW)        (MACORIG-\ITEM.WINDOW.BUTTON.HANDLER WINDOW])(MACINT-SNAPW  [LAMBDA NIL                                           (* ; "Edited 18-May-2020 17:20 by rmk:")    (LET ((W (MACORIG-SNAPW)))         [WINDOWPROP W 'BUTTONEVENTFN (FUNCTION (LAMBDA (W)                                                  (TOTOPW W)                                                  (MOVEW W]         W]))(RPAQ? MACINTERFACECORNERMARGIN 25)(MOVD? '\TEDIT.BUTTONEVENTFN 'MACORIG\TEDIT.BUTTONEVENTFN)(MOVD 'MACINT\TEDIT.BUTTONEVENTFN '\TEDIT.BUTTONEVENTFN)(MOVD? 'SEDIT::BUTTONEVENTFN 'MACORIG\SEDIT-BUTTONEVENTFN)(MOVD 'MACINT\SEDIT-BUTTONEVENTFN 'SEDIT::BUTTONEVENTFN)(MOVD? 'ADD-EXEC 'MACORIG-ADD-EXEC)(MOVD 'MACINT-ADD-EXEC 'ADD-EXEC)(MOVD? 'DBG::DEBUGGER-BUTTON-EVENT 'MACORIG-DEBUGGER-BUTTON-EVENT)(MOVD 'MACINT-DEBUGGER-BUTTON-EVENT 'DBG::DEBUGGER-BUTTON-EVENT)(MOVD? '\ITEM.WINDOW.BUTTON.HANDLER 'MACORIG-\ITEM.WINDOW.BUTTON.HANDLER)(MOVD 'MACINT-\ITEM.WINDOW.BUTTON.HANDLER '\ITEM.WINDOW.BUTTON.HANDLER)(MOVD? 'SNAPW 'MACORIG-SNAPW)(MOVD 'MACINT-SNAPW 'SNAPW)(DECLARE%: DONTEVAL@LOAD DOEVAL@COMPILE DONTCOPY COMPILERVARS (ADDTOVAR NLAMA )(ADDTOVAR NLAML )(ADDTOVAR LAMA MACINT-ADD-EXEC))(DECLARE%: DONTCOPY  (FILEMAP (NIL (1747 5706 (INTITLEBAR 1757 . 1977) (INCORNER 1979 . 3394) (MACWINDOW.BUTTONEVENTFN 3396 . 5018) (MACWINDOW 5020 . 5704)) (5707 7601 (MACINT\TEDIT.BUTTONEVENTFN 5717 . 6008) (MACINT\SEDIT-BUTTONEVENTFN 6010 . 6237) (MACINT-ADD-EXEC 6239 . 6663) (MACINT-DEBUGGER-BUTTON-EVENT 6665 . 6896) (MACINT-\ITEM.WINDOW.BUTTON.HANDLER 6898 . 7250) (MACINT-SNAPW 7252 . 7599)))))STOP